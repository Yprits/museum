---
layout: pgs
---

<div class="exhibit">
  <!-- Блок характеристик в виде аккуратной таблицы -->
  <div class="specs">
    <div class="specs-grid">
      <div class="spec-name">Модель:</div>
      <div class="spec-value">{{ page.model }}</div>
      
      <div class="spec-name">Тип:</div>
      <div class="spec-value">{{ page.category }}</div>
      
      <div class="spec-name">Дата выпуска:</div>
      <div class="spec-value">{{ page.prodyear }}</div>
      
      {% if page.modelyears %}
      <div class="spec-name">Годы выпуска модели:</div>
      <div class="spec-value">{{ page.modelyears }}</div>
      {% endif %}
      
      {% if page.serial %}
      <div class="spec-name">Серийный номер:</div>
      <div class="spec-value">{{ page.serial }}</div>
      {% endif %}
      
      {% if page.manufacturer %}
      <div class="spec-name">Производитель:</div>
      <div class="spec-value">{{ page.manufacturer }}</div>
      {% endif %}
      
      {% if page.country %}
      <div class="spec-name">Страна:</div>
      <div class="spec-value">{{ page.country }}</div>
      {% endif %}
      
      {% if page.price %}
      <div class="spec-name">Цена:</div>
      <div class="spec-value">{{ page.price }}</div>
      {% endif %}
      
      {% if page.condition %}
      <div class="spec-name">Состояние:</div>
      <div class="spec-value">{{ page.condition }}</div>
      {% endif %}
      
      <!-- Статус коллекции с возможным выделением -->
      <div class="spec-name">Статус:</div>
      <div class="spec-value">
        {% assign status = page.collectionstatus | default: "" | upcase %}
        {% if status contains "ПОИСК" or status contains "ИЩУ" %}
          <span class="status-seek">{{ page.collectionstatus }}</span>
        {% else %}
          {{ page.collectionstatus }}
        {% endif %}
      </div>
      
      {% if page.innernumber %}
      <div class="spec-name">Внутренний номер:</div>
      <div class="spec-value">{{ page.innernumber }}</div>
      {% endif %}
      
      {% if page.acquired_date %}
      <div class="spec-name">Дата приобретения:</div>
      <div class="spec-value">{{ page.acquired_date }}</div>
      {% endif %}
      
      {% if page.complect %}
      <div class="spec-name">Комплектность:</div>
      <div class="spec-value">{{ page.complect }}</div>
      {% endif %}
      
      {% if page.cpu %}
      <div class="spec-name">Процессор:</div>
      <div class="spec-value">{{ page.cpu }}</div>
      {% endif %}
      
      {% if page.ram %}
      <div class="spec-name">Память:</div>
      <div class="spec-value">{{ page.ram }}</div>
      {% endif %}
      
      {% if page.mp %}
      <div class="spec-name">Основная статья:</div>
      <div class="spec-value">
        <a href="{{ page.mp }}">{{ page.model }}</a>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- Описание экспоната -->
  <div class="description">
    <div align="justify">
      {{ content }}
    </div>
  </div>

  <!-- Таблица с фотографиями -->
  <table class="photo-table">
    {% assign suffixes = "0,1,2,3,4,5,6,7,8,9,A,B,C,D,E,F" | split: "," %}
    {% assign thumb_domain = "https://thumbs2.imgbox.com/" %}
    {% assign image_domain = "https://images2.imgbox.com/" %}

    {% comment %} === НАЧАЛО ИЗМЕНЕНИЙ: ГЕНЕРАЦИЯ prev0 ИЗ photo0 === {% endcomment %}
    {% assign generated_prev0 = "" %}
    {% if page.photo0 and page.photo0 != empty and page.photo0 != "" %}
      {% assign url_parts_0 = page.photo0 | split: "/" %}
      {% if url_parts_0.size >= 4 %}
        {% assign path_with_suffix_0 = "" %}
        {% for part in url_parts_0 %}
          {% if forloop.index >= 4 %}
            {% assign path_with_suffix_0 = path_with_suffix_0 | append: part %}
            {% unless forloop.last %}
              {% assign path_with_suffix_0 = path_with_suffix_0 | append: "/" %}
            {% endunless %}
          {% endif %}
        {% endfor %}
        {% if path_with_suffix_0 and path_with_suffix_0 != empty and path_with_suffix_0 != "" %}
          {% assign parts_by_underscore_0 = path_with_suffix_0 | split: "_" %}
          {% if parts_by_underscore_0.size >= 1 %}
            {% assign base_0 = parts_by_underscore_0[0] %}
            {% if base_0 and base_0 != empty and base_0 != "" %}
              {% assign generated_prev0 = thumb_domain | append: base_0 | append: "_b.jpg" %}
              {% assign generated_full_url_0 = image_domain | append: base_0 | append: "_o.jpg" %}
            {% endif %}
          {% endif %}
        {% endif %}
      {% endif %}
    {% endif %}
    {% comment %} === КОНЕЦ ИЗМЕНЕНИЙ === {% endcomment %}

    {% for suffix in suffixes %}
      {% assign photo_var = "photo" | append: suffix %}
      {% assign text_var = "text" | append: suffix %}
      {% assign full_url = page[photo_var] %}
      {% assign description = page[text_var] %}

      {% comment %} ГЛАВНАЯ ПРОВЕРКА: ссылка существует и не пустая {% endcomment %}
      {% if full_url and full_url != empty and full_url != "" %}
        {% comment %} === ИЗМЕНЕНИЕ: ДЛЯ photo0 ИСПОЛЬЗУЕМ УЖЕ ВЫЧИСЛЕННЫЕ ЗНАЧЕНИЯ === {% endcomment %}
        {% if suffix == "0" and generated_prev0 != "" %}
          {% comment %} Используем заранее вычисленные значения для photo0 {% endcomment %}
          {% assign thumb_url = generated_prev0 %}
          {% assign full_photo_url = generated_full_url_0 %}
          {% assign base = base_0 %} {% comment %} base всё ещё нужен для генерации _t ссылки {% endcomment %}
        {% else %}
          {% comment %} Стандартная логика для photo1, photo2 и т.д. {% endcomment %}
          {% assign url_parts = full_url | split: "/" %}
          {% if url_parts.size >= 4 %}
            {% assign path_with_suffix = "" %}
            {% for part in url_parts %}
              {% if forloop.index >= 4 %}
                {% assign path_with_suffix = path_with_suffix | append: part %}
                {% unless forloop.last %}
                  {% assign path_with_suffix = path_with_suffix | append: "/" %}
                {% endunless %}
              {% endif %}
            {% endfor %}
            {% if path_with_suffix and path_with_suffix != empty and path_with_suffix != "" %}
              {% assign parts_by_underscore = path_with_suffix | split: "_" %}
              {% if parts_by_underscore.size >= 1 %}
                {% assign base = parts_by_underscore[0] %}
                {% if base and base != empty and base != "" %}
                  {% assign thumb_url = thumb_domain | append: base | append: "_b.jpg" %}
                  {% assign full_photo_url = image_domain | append: base | append: "_o.jpg" %}
                {% endif %}
              {% endif %}
            {% endif %}
          {% endif %}
        {% endif %}

        {% comment %} === ФИНАЛЬНАЯ ПРОВЕРКА И ВЫВОД === {% endcomment %}
        {% if base and base != empty and base != "" %}
          <tr>
            <td>
              <a href="{{ thumb_domain }}{{ base }}_t.jpg" target="_blank" rel="noopener noreferrer">
                <img src="{{ thumb_url }}" 
                     loading="lazy" 
                     alt="Фото: {% if description %}{{ description | strip_html | truncatewords: 5 }}{% else %}без описания{% endif %}">
              </a>
            </td>
            <td>
              {% if description and description != empty and description != "" %}
                <a href="{{ full_photo_url }}" target="_blank" rel="noopener noreferrer">
                  {{ description }}
                </a>
              {% else %}
                <a href="{{ full_photo_url }}" target="_blank" rel="noopener noreferrer">
                  <em>(описание отсутствует)</em>
                </a>
              {% endif %}
            </td>
          </tr>
        {% endif %}
      {% endif %}
    {% endfor %}
  </table>
</div>
